---
title: "Environmental Injustice in Los Angeles County"
author: "Joshua Ferrer-Lozano"
date: "10/23/2025"
format: html
editor: visual
code-fold: false
execute:
  warning: false
  message: false
  echo: true
---
## Library Importing
```{r}
#imported necessary libraries for this analysis
library(stars)
library(tmap)
library(tidyverse)
library(sf)
library(here)

```
## Reading in Data
```{r}
# read in geodatabase of EJScreen data at the Census Block Group level
ejscreen <- sf::st_read(here::here("data", "ejscreen","EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb"),quiet =TRUE) 
```
## Selecting Los Angeles County for Analysis
```{r}
# filter to a state you are interested in
california <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "CA") 

# filter to a county you are interested in
los_angeles <- ejscreen %>%
  dplyr::filter(CNTY_NAME %in% c("Los Angeles County"))
  
```
## Creating a map to Illustrate PM2.5 Concentrations in LA County
```{r}
#| warning: false

#plotting a custom bbox visual (removing islands) of particulate matter by concentration
tmap_mode('plot') +
tm_shape(los_angeles, bbox = c(-118.94,33.7,-117.64,34.8)) +
  tm_graticules() +
  tm_polygons(
    fill = "PM25",
    palette = "brewer.yl_or_rd",
    title = "PM2.5 (µg/m^3)",
    fill.scale = "quantile",
  ) +
  tm_borders() +
  tm_layout(
    main.title = "Particulate Matter (PM2.5) Concentration in Los Angeles County",
    main.title.position = c("center", "top"),
    legend.outside = TRUE
  ) +
  # adding scale bar and compass
  tm_scale_bar(position = c(-0,0.2), text.size = 0.6) +
  tm_compass(position = c(0.8,.2), size = 1.5)
```
Because LA County is very large and includes islands, custom bbox values were necessary to remove the islands included in the county for a better view of the area related to the analysis. We can see that the inner eastern part of LA County has higher concentrations of particulate matter, indicating lower quality of air or higher concentration of air pollution.

## Readjusting LA visual for Clarity on Areas with Higher Concentrations (Eastern LA County)
```{r}
#| warning: false

#plotting a custom bbox visual of particulate matter by concentration
tmap_mode('plot') +
tm_shape(los_angeles, 
         #We use customized bbox values to zoom into the area of interest
         bbox = c(-118.55,33.7,-117.64,34.25)) +
  tm_graticules() +
  tm_polygons(
    fill = "PM25",
    palette = "brewer.yl_or_rd",
    fill.legend = tm_legend(title = "PM2.5 (µg/m^3)"),
    fill.scale = "quantile"
  ) +
  tm_borders() +
  tm_layout(
    main.title = "Particulate Matter (PM2.5) Concentration in Los Angeles County",
    main.title.position = c("center", "top"),
    legend.outside = TRUE
    # adding scale bar and compass
  ) +
  tm_scale_bar(position = c(.6,0.2), text.size = 0.6) +
  tm_compass(position = c(0.9,.2), size = 1.5)

```
Updating the map to zoom into inner LA County, the map removes areas of northern LA County that includes Antelope valley. Based on this visualization, we get a clearer picture of the magnitude of higher concentrations of particulate matter, where inner areas are almost double the concentration levels.

## Changing Filter to Minority Population Concentrations in Eastern LA County
```{r}
#| warning: false
# narrowing in on the areas that illustrate higher levels of particulate matter - specifically areas of higher minority population percentage.
tmap_mode('plot') +
  # custom bbox values to focus on LA county's eastern area.
tm_shape(los_angeles, bbox = c(-118.32,33.8,-117.7,34.2)) + 
  tm_graticules() +
  tm_graticules() +
  tm_polygons(
    fill = "PEOPCOLORPCT",
    fill.scale = tm_scale_intervals(values = "brewer.blues", style = "quantile"),
    fill.legend = tm_legend(title = "% Minority Population")
  ) +
  tm_borders() +
  tm_title("Demographic Vulnerability: Minority Population in (Eastern) Los Angeles County") +
  tm_scale_bar(position = c(.6,0.2), text.size = 0.6) +
  tm_compass(position = c(0.9,.2), size = 1.5)
```
Usinging the percentage of minority population variable, we are able to discern which block groups have higher concentrations. Comparing the previous map to the map above, we can indicate that these areas are more prone to higher levels of air pollution. This can conclude that areas of higher percentage of minorities have also higher exposure to air pollutants.

## Visualizing Cancer Risk due to Air Toxics in Eastern LA County
```{r}
#| warning: false
#Percentile for air toxics cancer risk
tmap_mode('plot') +
tm_shape(los_angeles, bbox = c(-118.32,33.8,-117.7,34.2)) + tm_graticules() +
  tm_polygons(
    fill = "P_CANCER",
    fill.scale = tm_scale_intervals(values = "brewer.yl_or_rd", style = "quantile"),
    fill.legend = tm_legend(title = "Percentile for Air Toxics Cancer Risk")
  ) +
  tm_borders() +
  tm_title("Block Group Percentile for Air Toxics Cancer Risk in Los Angeles County") +
  tm_scale_bar(position = c(.5,0.2), text.size = 0.5) +
  tm_compass(position = c(0.9,.2), size = 1.5)
```
Comparing this graph with the other two, we can associate higher pollution concentrations with air toxics cancer risk. We can see the highest risk in the inner city (around Union Station/Chinatown/Compton) but still see surrounding areas with about 40-60 percent cancer risk.

# Conclusion

Based on the above analysis of Los Angeles county and variables of interest, the overlays of maps illustrate that the variables "Particulate Matter in Air" and "Percentile for Toxics Cancer Risk" have a positive correlation, or rather, as particulate matter concentration increases the likelihood of cancer risk also increases. Furthermore, by adding the "People of Color %" data, we can determine that these same high risk block groups are predominately minority populations illustrating that people of color in this instance - in LA County - to develop ailments due to environmental factors such as air quality (particulate matter). 
